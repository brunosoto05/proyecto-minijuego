import javax.swing.*;
import java.awt.*;
import java.util.Random;

public class GameView extends JFrame {

    private JLabel scoreLabel;
    private JLabel timeLabel;
    private JLabel statusLabel;

    private JButton startButton;
    private JButton targetButton;

    private JPanel topPanel;
    private JPanel playPanel;
    private JPanel bottomPanel;

    private Random random;

    public GameView() {
        super("Minijuego - Haz clic al objetivo");

        random = new Random();

        initComponents();
        configureLayout();
        configureWindow();
    }

    private void initComponents() {
        scoreLabel = new JLabel("Puntaje: 0");
        timeLabel = new JLabel("Tiempo: 30");
        statusLabel = new JLabel("");

        startButton = new JButton("Iniciar juego");
        targetButton = new JButton("X");
        targetButton.setFocusPainted(false);

        topPanel = new JPanel(new FlowLayout(FlowLayout.CENTER, 20, 5));
        playPanel = new JPanel(null);
        bottomPanel = new JPanel(new FlowLayout(FlowLayout.CENTER, 20, 5));

        playPanel.setPreferredSize(new Dimension(400, 300));
        playPanel.setBackground(new Color(230, 230, 250));
        targetButton.setBounds(150, 100, 60, 40);

        playPanel.add(targetButton);
    }

    private void configureLayout() {
        topPanel.add(scoreLabel);
        topPanel.add(timeLabel);

        bottomPanel.add(statusLabel);
        bottomPanel.add(startButton);

        setLayout(new BorderLayout(10, 10));
        add(topPanel, BorderLayout.NORTH);
        add(playPanel, BorderLayout.CENTER);
        add(bottomPanel, BorderLayout.SOUTH);
    }

    private void configureWindow() {
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setSize(500, 450);
        setLocationRelativeTo(null);
        setResizable(false);
        setVisible(true);
    }

    public void setScore(int score) {
        scoreLabel.setText("Puntaje: " + score);
    }

    public void setTimeLeft(int timeLeft) {
        timeLabel.setText("Tiempo: " + timeLeft);
    }

    public void setStatus(String status) {
        statusLabel.setText("Estado: " + status);
    }

    public void setGameRunning(boolean running) {
        startButton.setEnabled(!running);
        targetButton.setEnabled(running);
    }

    public void moveTargetRandom() {
        int panelWidth = playPanel.getWidth();
        int panelHeight = playPanel.getHeight();

        int btnWidth = targetButton.getWidth();
        int btnHeight = targetButton.getHeight();

        if (panelWidth <= 0 || panelHeight <= 0) {
            return;
        }

        int maxX = panelWidth - btnWidth;
        int maxY = panelHeight - btnHeight;

        if (maxX < 0) maxX = 0;
        if (maxY < 0) maxY = 0;

        int x = random.nextInt(Math.max(1, maxX + 1));
        int y = random.nextInt(Math.max(1, maxY + 1));

        targetButton.setLocation(x, y);
        playPanel.repaint();
    }
}
    public void addStartButtonListener(java.awt.event.ActionListener listener) {
        startButton.addActionListener(listener);
    }

    public void addTargetButtonListener(java.awt.event.ActionListener listener) {
        startButton.addActionListener(listener);
    }
}
